<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Penalized Cubic regression splines in GAMs</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for smooth.construct.cr.smooth.spec {mgcv}"><tr><td>smooth.construct.cr.smooth.spec {mgcv}</td><td align="right">R Documentation</td></tr></table>
<h2>Penalized Cubic regression splines in GAMs</h2>


<h3>Description</h3>

<p>
<code><a href="gam.html">gam</a></code> can use univariate penalized cubic regression spline smooths, specified via terms like
<code>s(x,bs="cr")</code>. <code>s(x,bs="cs")</code> specifies a penalized cubic regression spline in which a small ridge 
penalty has been added to the cubic spline penalty, in order to allow the term to be shrunk  to zero if the 
smoothing parameter is high enough (as the smoothing parameter goes to infinity a normal cubic spline tends to a 
straight line.) <code>s(x,bs="cc")</code> specifies a cyclic penalized cubic regression spline smooth.
</p>
<p>
`Cardinal' spline bases are used: Wood (2006) sections 4.1.2 and 4.1.3 gives full details. These bases have 
very low setup costs. For a given basis dimension, <code>k</code>, they typically perform a little less well 
then thin plate regression splines, but a little better than p-splines. See <code><a href="te.html">te</a></code> to use these bases in tensor product smooths of several variables.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'cr.smooth.spec':
smooth.construct(object, data, knots)
## S3 method for class 'cs.smooth.spec':
smooth.construct(object, data, knots)
## S3 method for class 'cc.smooth.spec':
smooth.construct(object, data, knots)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
a smooth specification object, usually generated by a term <code>s(...,bs="cr",...)</code>,
<code>s(...,bs="cs",...)</code> or <code>s(...,bs="cc",...)</code></td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
a list containing just the data (including any <code>by</code> variable) required by this term, 
with names corresponding to <code>object$term</code> (and <code>object$by</code>). The <code>by</code> variable 
is the last element.</td></tr>
<tr valign="top"><td><code>knots</code></td>
<td>
a list containing any knots supplied for basis setup &mdash; in same order and with same names as <code>data</code>. 
Can be <code>NULL</code></td></tr>
</table>

<h3>Details</h3>

<p>
The constructor is not normally called directly, but is rather used internally by <code><a href="gam.html">gam</a></code>. 
To use for basis setup it is recommended to use <code><a href="smooth.construct.html">smooth.construct2</a></code>.  
</p>
<p>
If they are not supplied then the knots  of the spline are placed evenly
throughout the covariate values to which the term refers:  For
example, if fitting 101 data with an 11 knot spline of <code>x</code> then
there would be a knot at every 10th (ordered)  <code>x</code> value. The
parameterization used represents the spline in terms of its
values at the knots. The values at neighbouring knots
are connected by sections of  cubic polynomial constrained to be 
continuous up to and including second derivative at the knots. The resulting curve
is a natural cubic  spline through the values at the knots (given two extra conditions specifying 
that the second derivative of the curve should be zero at the two end 
knots).
</p>
<p>
Note that the cyclic smoother will wrap at the smallest and largest covariate values, unless knots are supplied, and 
is not subject to the condition that second derivatives go to zero at the first and last knots.
</p>


<h3>Value</h3>

<p>
An object of class <code>"cr.smooth"</code> <code>"cs.smooth"</code> or <code>"cyclic.smooth"</code>.
In addition to the usual elements of a smooth class documented under <code><a href="smooth.construct.html">smooth.construct</a></code>, 
this object will contain:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>xp</code></td>
<td>
giving the knot locations used to generate the basis.</td></tr>
<tr valign="top"><td><code>BD</code></td>
<td>
class <code>"cyclic.smooth"</code> objects include matrix <code>BD</code> which transforms function values 
at the knots to second derivatives at the knots.</td></tr>
</table>
<p>

normal-bracket51bracket-normal</p>

<h3>Author(s)</h3>

<p>
Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a>
</p>


<h3>References</h3>

<p>
Wood S.N. (2006) Generalized Additive Models: An Introduction with R. Chapman
and Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre>
## cyclic spline example...
  set.seed(6)
  x &lt;- sort(runif(200)*10)
  z &lt;- runif(200)
  f &lt;- sin(x*2*pi/10)+.5
  y &lt;- rpois(exp(f),exp(f)) 

## finished simulating data, now fit model...
  b &lt;- gam(y ~ s(x,bs="cc",k=12) + s(z),family=poisson,
                      knots=list(x=seq(0,10,length=12)))
## plot results...
  par(mfrow=c(2,2))
  plot(x,y);plot(b,select=1,shade=TRUE);lines(x,f-mean(f),col=2)
  plot(b,select=2,shade=TRUE);plot(fitted(b),residuals(b))
  

</pre>



<hr><div align="center">[Package <em>mgcv</em> version 1.4-1 <a href="00Index.html">Index]</a></div>

</body></html>
